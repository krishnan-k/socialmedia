import React, { useState } from "react";
import { FaUserAlt } from "react-icons/fa";
import "../component-css/Navbar.css";
import { Link, useNavigate, useLocation } from "react-router-dom";
import { observer } from "mobx-react";
import postStore from "../store/PostStore";
import { Container } from "@mui/material";
import { HiOutlineMenuAlt1 } from "react-icons/hi";
import { IoIosCloseCircle } from "react-icons/io";

const Navbar: React.FC = observer(() => {
  const [drawerOpen, setDrawerOpen] = useState(false);
  const navigate = useNavigate();
  const location = useLocation();

  const toggleDrawer = () => {
    setDrawerOpen(!drawerOpen);
  };

  const navLinks = [
    { path: "/", label: "Home" },
    { path: "/create", label: "New Post" },
  ];

  const handleLogout = () => {
    postStore.logout();
    navigate("/login");
  };

  return (
    <div
      className={`navbar-section ${drawerOpen ? "active" : ""} bg-[#f9fcff]`}
      style={{ borderBottom: "1px solid rgba(0, 0, 0, 0.2)" }}
    >
      <Container maxWidth="lg">
        <div className="navbar-content">
          <div className="header-section">
            <div className="logo">
              <Link to="/">
                <h1>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="203.713"
                    height="48.404"
                    viewBox="0 0 203.713 48.404"
                  >
                    <g
                      id="Footer-logo_text"
                      data-name="Footer-logo+text"
                      transform="translate(1.212 1.202)"
                    >
                      <path
                        id="logo_text"
                        data-name="logo+text"
                        d="M-963.95,1026.929l13.865-13.784h9.269l-23.134,23Zm128.448,1.647a9.1,9.1,0,0,1-5.263-1.506,8.084,8.084,0,0,1-3.108-4.285l-.045-.135h3.72a4.28,4.28,0,0,0,1.52,1.646,5.821,5.821,0,0,0,3.175.834,5.188,5.188,0,0,0,3.969-1.533,5.93,5.93,0,0,0,1.386-3.428c-.272.2-.544.384-.817.564a9.416,9.416,0,0,1-4.786,1.285,9.081,9.081,0,0,1-6.51-2.638,9.389,9.389,0,0,1,0-13.035,9.331,9.331,0,0,1,11.365-1.308c.363.248.681.474,1.02.744v-.005l.069-1.781h3.243v14.973a9.984,9.984,0,0,1-2.382,6.968,8.527,8.527,0,0,1-6.18,2.647C-835.251,1028.585-835.377,1028.582-835.5,1028.577Zm3.809-11.591a6.1,6.1,0,0,0,0-8.208,5.5,5.5,0,0,0-4.015-1.6,5.628,5.628,0,0,0-4.058,1.624,5.707,5.707,0,0,0-1.633,4.083,5.858,5.858,0,0,0,1.633,4.082h0a5.628,5.628,0,0,0,4.058,1.624A5.463,5.463,0,0,0-831.693,1016.985Zm-28.058,4.442a5.881,5.881,0,0,1-2.313-4.353l-.114-1.378h3.493l.113,1.151a2.621,2.621,0,0,0,1.044,1.894,4.911,4.911,0,0,0,2.926.744,5.063,5.063,0,0,0,2.969-.767,1.939,1.939,0,0,0,.862-1.623,1.711,1.711,0,0,0-.975-1.624,11.655,11.655,0,0,0-3.244-.858,14.021,14.021,0,0,1-4.287-1.2,4.38,4.38,0,0,1-2.475-4.172,4.983,4.983,0,0,1,2.109-4.1,8.1,8.1,0,0,1,4.9-1.444,7.9,7.9,0,0,1,4.9,1.467,5.566,5.566,0,0,1,2.154,4.217l.069,1.353h-3.471l-.091-1.2a2.212,2.212,0,0,0-.885-1.714,4.526,4.526,0,0,0-2.7-.7,4.785,4.785,0,0,0-2.723.676,1.671,1.671,0,0,0-.771,1.421c0,1.331,1.837,1.624,3.9,1.985a14.076,14.076,0,0,1,4.491,1.285,4.811,4.811,0,0,1,2.608,4.555,5.4,5.4,0,0,1-2.2,4.352l0,0a8.6,8.6,0,0,1-5.195,1.533c-.106,0-.211.006-.317.006A8.305,8.305,0,0,1-859.751,1021.428Zm-65.553,0a5.883,5.883,0,0,1-2.314-4.353l-.113-1.378h3.493l.114,1.151a2.622,2.622,0,0,0,1.043,1.894,4.911,4.911,0,0,0,2.926.744,5.063,5.063,0,0,0,2.97-.767,1.937,1.937,0,0,0,.862-1.623,1.71,1.71,0,0,0-.975-1.624,11.656,11.656,0,0,0-3.243-.858,14.022,14.022,0,0,1-4.287-1.2,4.38,4.38,0,0,1-2.474-4.172,4.983,4.983,0,0,1,2.109-4.1,8.093,8.093,0,0,1,4.9-1.444,7.9,7.9,0,0,1,4.9,1.467,5.57,5.57,0,0,1,2.155,4.217l.068,1.353h-3.471l-.091-1.2a2.214,2.214,0,0,0-.885-1.714,4.526,4.526,0,0,0-2.7-.7,4.783,4.783,0,0,0-2.722.676,1.671,1.671,0,0,0-.771,1.421c0,1.331,1.837,1.624,3.9,1.985a14.076,14.076,0,0,1,4.491,1.285,4.81,4.81,0,0,1,2.608,4.555,5.4,5.4,0,0,1-2.2,4.352l0,0a8.6,8.6,0,0,1-5.194,1.533c-.105,0-.211.006-.317.006A8.3,8.3,0,0,1-925.3,1021.428Zm124.758-1.258a9.938,9.938,0,0,1,0-13.667,9.381,9.381,0,0,1,6.782-2.774,9.721,9.721,0,0,1,5.081,1.377,7.81,7.81,0,0,1,1.132.783h0l.045-1.87h3.334v18.6h-3.357l-.045-1.87a10.045,10.045,0,0,1-1.112.812,9.714,9.714,0,0,1-5.081,1.377h-.117A9.382,9.382,0,0,1-800.546,1020.169Zm2.516-11.258a6.468,6.468,0,0,0,0,8.8,6.245,6.245,0,0,0,8.62.022,6.592,6.592,0,0,0,0-8.84,6.22,6.22,0,0,0-4.3-1.714A6.222,6.222,0,0,0-798.03,1008.912Zm-109.718,11.258a9.938,9.938,0,0,1,0-13.667,9.383,9.383,0,0,1,6.783-2.774,9.721,9.721,0,0,1,5.08,1.377,7.8,7.8,0,0,1,1.134.787v0l.046-1.87h3.335v18.6h-3.357l-.046-1.87a9.989,9.989,0,0,1-1.111.812,9.714,9.714,0,0,1-5.08,1.377h-.117A9.384,9.384,0,0,1-907.748,1020.169Zm2.518-11.262a6.468,6.468,0,0,0,0,8.8,6.247,6.247,0,0,0,8.619.022,6.592,6.592,0,0,0,0-8.84,6.221,6.221,0,0,0-4.3-1.714A6.222,6.222,0,0,0-905.23,1008.908Zm90.387,14.012a9.138,9.138,0,0,1-6.691-2.8,10.03,10.03,0,0,1,.022-13.667,9.213,9.213,0,0,1,6.691-2.774,9.107,9.107,0,0,1,6.556,2.756l.006-.007a9.654,9.654,0,0,1,2.63,6.763l-.068,1.673h-14.858a6.08,6.08,0,0,0,1.584,2.931,6.012,6.012,0,0,0,7.19.812,6.442,6.442,0,0,0,1.633-1.511h3.992l-.113.2a9.952,9.952,0,0,1-3.493,4.15,9.063,9.063,0,0,1-4.946,1.467Zm-4.053-14.21a5.937,5.937,0,0,0-1.584,2.706h11.132a5.648,5.648,0,0,0-1.543-2.707h0a5.565,5.565,0,0,0-3.969-1.556h-.086A5.79,5.79,0,0,0-818.9,1008.709Zm-54.855,14.21a9.139,9.139,0,0,1-6.691-2.8,10.03,10.03,0,0,1,.025-13.669,9.21,9.21,0,0,1,6.691-2.775,9.111,9.111,0,0,1,6.556,2.755h0a9.655,9.655,0,0,1,2.63,6.762l-.068,1.673h-14.857a6.073,6.073,0,0,0,1.584,2.931,6.012,6.012,0,0,0,7.19.812,6.442,6.442,0,0,0,1.633-1.511h3.992l-.113.2a9.953,9.953,0,0,1-3.493,4.15,9.06,9.06,0,0,1-4.946,1.467Zm-4.054-14.209a5.94,5.94,0,0,0-1.584,2.707h11.137a5.644,5.644,0,0,0-1.547-2.709v0a5.566,5.566,0,0,0-3.969-1.556h-.084A5.792,5.792,0,0,0-877.806,1008.711Zm95.995,13.931v-18.6h3.266l.068,1.444a2.175,2.175,0,0,1,.453-.339v0a7.57,7.57,0,0,1,4.151-1.15h2.653v3.45h-2.722a4.105,4.105,0,0,0-3.107,1.285,5.221,5.221,0,0,0-1.247,3.586v10.325Zm-104.978-.019h-2.246V998.335h3.516v24.289Zm-86.431-9.478,23.135-23v9.217l-13.865,13.784Z"
                        transform="translate(973.22 -990.145)"
                        fill="#3953fb"
                        stroke="rgba(0,0,0,0)"
                        stroke-width="1"
                      ></path>
                    </g>
                  </svg>
                </h1>
              </Link>
            </div>
            <div className="navigation">
              <button
                className="drawer-toggle ml-auto cursor-pointer"
                onClick={toggleDrawer}
              >
                <HiOutlineMenuAlt1 className="w-[35px] h-[35px] mr-4 text-[#ff5200]" />
              </button>
              <div className={`nav-content ${drawerOpen ? "open" : ""}`}>
                <button className="drawer-close p-2" onClick={toggleDrawer}>
                  <IoIosCloseCircle className="w-[35px] h-[35px] text-[#ff5200]" />
                </button>
                <nav>
                  <ul>
                    {navLinks.map((link) => (
                      <li
                        key={link.path}
                        className={`${
                          location.pathname === link.path ? "active" : ""
                        }`}
                      >
                        <Link to={link.path}>{link.label}</Link>
                      </li>
                    ))}
                  </ul>
                </nav>
              </div>
            </div>
            <div className="account-icon ms-2 me-0">
              {postStore.isAuthenticated ? (
                <button
                  className="nav-link text-uppercase ms-2 me-2 fw-normal fx"
                  onClick={handleLogout}
                >
                  <FaUserAlt />
                  <div className="account_section">
                    <p className="address-login m-0">Log out</p>
                  </div>
                </button>
              ) : (
                <div className="account_login">
                  <Link
                    className="nav-link text-uppercase ms-2 me-2 fw-normal fx"
                    to="/login"
                  >
                    <FaUserAlt />
                    <div className="account_section">
                      <p className="address-login m-0">Log in</p>
                    </div>
                  </Link>
                </div>
              )}
            </div>
          </div>
        </div>
      </Container>
    </div>
  );
});

export default Navbar;
